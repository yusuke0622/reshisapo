
<div class="container mt-5">
    <div class="col-md-10 mx-auto">
        <div class="row col-md-12">
            <div>
                <h2 class="text-left">
                    <%= @recipe.recipe_name %>
                    <small class="font-weight-light text-sm">♡<%= @recipe.favorites.count %></small>
                </h2>
            </div>
            <div class="ml-auto">
                <% if user_signed_in? %>
                    <% if @recipe.user_id != current_user.id %>
                        <% if @recipe.favorited?(current_user) %>
                            <%= link_to 'お気に入り解除', recipe_favorites_path(@recipe.id), class: 'btn btn-outline-warning ml-2 d-flex justify-content-end', method: :delete %>
                        <% else %>
                            <%= link_to  'お気に入り登録', recipe_favorites_path(@recipe.id), class: 'btn btn-warning ml-2 d-flex justify-content-end', method: :post %>
                        <% end %>
                    <% end %>
                <% end %>
            </div>
        
        </div>
        <div class="row col-md-12 mt-3">
            <div class="col-md-8 d-flex justify-content-center"><!--レシピ画像--->
                <% if @recipe.recipe_image.attached? %> 
                    <%= image_tag @recipe.recipe_image.variant(resize: "300x300"), style: "object-fit: cover;" %>
                <% else %>
                    <%= image_tag 'no_recipe_image.png', :size => "300x300", style: "object-fit: cover;" %>
                <% end %>
            </div>
            <div class="col-md-4 d-flex flex-column align-items-start justify-content-center">
                <% if user_signed_in? %>
                    <%= render partial: 'show_user_signed_in' %>
                <% else %>
                    <%= render partial: 'show_user_not_signed' %>
                <% end %>
            </div>    
        </div>
        
        <div class="row d-flex flex-column col-md-12 mt-5">
            <h2 class="text-left">材料
                <small>（<%= @recipe.serving %>人分）</small>
            </h2>
            <table class="table col-md-8 mx-auto mt-4">
                <tr class="table-light">
                    <th>食材・調味料</th>
                    <th>分量</th>
                </tr>
                <% @recipe.ingredients.each do |ingredient| %>
                <tr>
                    <td><%= ingredient.ingredient_name %></td>
                    <td><%= ingredient.quantity %></td>
                </tr>
                <% end %>
            </table>
        </div>
        <div class="row d-flex flex-column mt-5 col-md-12">
            <h2 class="text-left">作り方</h2>
            <div class="col-md-10 mx-auto mt-5">
                <div class="d-flex flex-wrap">
                    <% @recipe.steps.each do |step| %>
                        <div class="col-md-6">
                            <div class="mr-auto">
                                <span class="border rounded-lg border-dark py-2 px-3 bg-secondary text-light"><%= step.number %></span>
                            </div>
                            <div class="d-flex flex-column justify-content-center">
                                <% if step.step_image.attached? %>
                                    <%= image_tag step.step_image.variant(resize: "220x220"), style: "object-fit: cover;" %>
                                <% else %>
                                    <%= image_tag 'no_recipe_image.png', :size => "220x220" , style: "object-fit: cover;"%>
                                <% end %>
                                <p><%= step.explanation %></p>
                            </div>
                        </div>
                    <% end %>
                </div>
            </div>
        </div>
        <% if user_signed_in? %>
            <div class="row col-md-12 d-flex flex-column mt-5">
                <%= render partial: 'show_comment' %>
            </div>
        <% end %>
         <% if @recipe.user_id == current_user.id %>
                <div style="margin-top: 100px;" class="row d-flex justify-content-center">
                    <%= link_to '編集', edit_recipe_path(@recipe.id), class: 'btn btn-outline-success mr-4 col-md-2' %>
                    <%= link_to '削除', recipe_path(@recipe.id), class: 'btn btn-outline-danger col-md-2', method: :delete, data: { confirm: "本当に削除しますか?" } %>
                </div>
        <% end %>
    </div>
</div>
